---
title: "project1_new"
author: "Hui Zhang"
date: "Tuesday, October 21, 2014"
output: html_document
---

Introduction 
```{r,echo=FALSE}
grade <- read.table(file="project_new.txt", header=T)

```
This is the project for the first half of the semester for course Microbiol 612.This project will analyze the final grades of first-year high school students. All the data are download from [wenku.baidu.com](http://wenku.baidu.com/view/09f6dc3752ea551811a68727.html).      

There are `r ncol(grade)-2` subjects in the final exam. The `r ncol(grade)-2` subjects are: `r colnames(grade)[3:10]`. `r nrow(grade)` students are collected in this project. When I was in high school, senior students and teachers told us grade of `r colnames(grade)[4]` and `r colnames(grade)[6]` could reflect the total grade. In other words, if I could get high grade in `r colnames(grade)[5]`, my total grades would not be low. Now, I will use the grades I collected to test this regular pattern.


Data Analysis    

Plotting    

1. Total grade distribution    
The average total grade is `r summary(grade$Total)["Mean"]`. The median grade of `r colnames(grade$Total)` is `r summary(grade$Total)["Median"]`.The minimum total grade is `r summary(grade$Total)["Min."]`, and the maximum total grade is `r summary(grade$Total)["Max."]`. The standard deviation of total grade is `r sd(grade$Total)`.     

Is the grade normally distributed?
      
```{r,,echo=FALSE}
total.hist<-hist(grade$Total,plot=F,breaks=200)
plot(total.hist$density~total.hist$mids,type="h",ylab="Density",xlab="Total grade",main="Total Grade Distribution")
points(0:1500,dnorm(0:1500,600,88),type="l",col="red",lwd=2)

```
       
From the figure above, total grade are normally distributed. Then how about grade of single subject? Let's check it!      

2. Single subject distribution     
(1) The average grade of `r colnames(grade[3])` is `r summary(grade[,3])["Mean"]`. The median grade of `r colnames(grade[3])` is `r summary(grade[,3])["Median"]`.The minimum total grade is `r summary(grade[,3])["Min."]`, and the maximum total grade is `r summary(grade$Chinese)["Max."]`. The standard deviation of total grade is `r sd(grade$Chinese)`.     

Is the grade normally distributed?
      
```{r,,echo=FALSE}
chinese.hist<-hist(grade$Chinese,plot=F,breaks=200)
plot(chinese.hist$density~chinese.hist$mids,type="h",ylab="Density",xlab="Chinese grade",main="Chinese Grade Distribution")
points(0:150,dnorm(0:150,101,9),type="l",col="red",lwd=2)

```
       
From the figure above, Chinese grade are normally distributed.     

(2) The average grade of `r colnames(grade[4])` is `r summary(grade[,4])["Mean"]`. The median grade of `r colnames(grade[4])` is `r summary(grade[,4])["Median"]`. The minimum total grade is `r summary(grade[,4])["Min."]`, and the maximum total grade is `r summary(grade$Math)["Max."]`. The standard deviation of total grade is `r sd(grade$Math)`.     

Is the grade normally distributed?
      
```{r,,echo=FALSE}
math.hist<-hist(grade$Math,plot=F,breaks=200)
plot(math.hist$density~math.hist$mids,type="h",ylab="Density",xlab="Math grade",main="Math Grade Distribution")
points(0:150,dnorm(0:150,105.6,23),type="l",col="red",lwd=2)

```
       
From the figure above, Math grade are normally distributed.     

(3) The average grade of `r colnames(grade[5])` is `r summary(grade[,5])["Mean"]`. The median grade of `r colnames(grade[5])` is `r summary(grade[,5])["Median"]`. The minimum total grade is `r summary(grade[,5])["Min."]`, and the maximum total grade is `r summary(grade[,5])["Max."]`. The standard deviation of total grade is `r sd(grade[,5])`.     

Is the grade normally distributed?
      
```{r,,echo=FALSE}
eng.hist<-hist(grade$English,plot=F,breaks=200)
plot(eng.hist$density~eng.hist$mids,type="h",ylab="Density",xlab="English grade",main="English Grade Distribution")
points(0:150,dnorm(0:150,109,16),type="l",col="red",lwd=2)

```
       
From the figure above, English grade are normally distributed.    

(4) The average grade of `r colnames(grade[6])` is `r summary(grade[,6])["Mean"]`. The median grade of `r colnames(grade[6])` is `r summary(grade[,6])["Median"]`. The minimum total grade is `r summary(grade[,6])["Min."]`, and the maximum total grade is `r summary(grade[,6])["Max."]`. The standard deviation of total grade is `r sd(grade[,6])`.     

Is the grade normally distributed?
      
```{r,,echo=FALSE}
phy.hist<-hist(grade$Physics,plot=F,breaks=200)
plot(phy.hist$density~phy.hist$mids,type="h",ylab="Density",xlab="Physics grade",main="Physics Grade Distribution")
points(0:100,dnorm(0:100,62,22),type="l",col="red",lwd=2)

```
       
From the figure above, Physics grade distribution almost follow normal distribution.    

(5) The average grade of `r colnames(grade[7])` is `r summary(grade[,7])["Mean"]`. The median grade of `r colnames(grade[7])` is `r summary(grade[,7])["Median"]`. The minimum total grade is `r summary(grade[,7])["Min."]`, and the maximum total grade is `r summary(grade[,7])["Max."]`. The standard deviation of total grade is `r sd(grade[,7])`.     

Is the grade normally distributed?
      
```{r,,echo=FALSE}
chem.hist<-hist(grade$Chemistry,plot=F,breaks=200)
plot(chem.hist$density~chem.hist$mids,type="h",ylab="Density",xlab="Chemistry grade",main="Chemistry Grade Distribution")
points(0:100,dnorm(0:100,64,20),type="l",col="red",lwd=2)

```
       
From the figure above, Chemistry grade distribution is not well normally distributed.       
```{r,echo=FALSE}
stripchart(grade$Chemistry,method="jitter",jitter=0.02)
freq <- tapply(grade$Chemistry,grade$Chemistry,length)
```
        
From the figure above, most grades are concentrated around 60 to 90. The mode of Chemistry grade is `r as.numeric(names(freq)[which.max(freq)])`.
       
       
(6) The average grade of `r colnames(grade[8])` is `r summary(grade[,8])["Mean"]`. The median grade of `r colnames(grade[8])` is `r summary(grade[,8])["Median"]`. The minimum total grade is `r summary(grade[,8])["Min."]`, and the maximum total grade is `r summary(grade[,8])["Max."]`. The standard deviation of total grade is `r sd(grade[,8])`.     

Is the grade normally distributed?
      
```{r,,echo=FALSE}
poli.hist<-hist(grade$Politics,plot=F,breaks=200)
plot(poli.hist$density~poli.hist$mids,type="h",ylab="Density",xlab="Politics grade",main="Politics Grade Distribution")
points(0:100,dnorm(0:100,47,13),type="l",col="red",lwd=2)

```
       
From the figure above, Politics grade are normally distributed.     

(7) The average grade of `r colnames(grade[9])` is `r summary(grade[,9])["Mean"]`. The median grade of `r colnames(grade[9])` is `r summary(grade[,9])["Median"]`. The minimum total grade is `r summary(grade[,9])["Min."]`, and the maximum total grade is `r summary(grade[,9])["Max."]`. The standard deviation of total grade is `r sd(grade[,9])`.     

Is the grade normally distributed?
      
```{r,,echo=FALSE}
histo.hist<-hist(grade$History,plot=F,breaks=200)
plot(histo.hist$density~histo.hist$mids,type="h",ylab="Density",xlab="History grade",main="History Grade Distribution")
points(0:100,dnorm(0:100,59,12),type="l",col="red",lwd=2)

```
       
From the figure above, History grade are normally distributed.      

(8) The average grade of `r colnames(grade[10])` is `r summary(grade[,10])["Mean"]`. The median grade of `r colnames(grade[10])` is `r summary(grade[,10])["Median"]`. The minimum total grade is `r summary(grade[,10])["Min."]`, and the maximum total grade is `r summary(grade[,10])["Max."]`. The standard deviation of total grade is `r sd(grade[,10])`.     

Is the grade normally distributed?
      
```{r,,echo=FALSE}
geo.hist<-hist(grade$Geography,plot=F,breaks=200)
plot(geo.hist$density~geo.hist$mids,type="h",ylab="Density",xlab="Geography grade",main="Geography Grade Distribution")
points(0:100,dnorm(0:100,52,16),type="l",col="red",lwd=2)

```
       
From the figure above, Geography grade are normally distributed.     

3. Relationships between subjects    
(1) It seems like a rule that students with good grade in math, also have good grade in physics. Is that true? Let's check!     
```{r,echo=FALSE}
math.p <- grade$Math/150
phy.p<-grade$Physics/100
plot(math.p~grade$Total,type="l",col="red",xlab="Total Grade",ylab="Subject Grade Percentage")
lines(phy.p~grade$Total,col="blue")
legend(250,0.9,legend=c("Math","Physics"),col=c("red","blue"),lwd=2)

```
      
Is there any difference between Math and Physics? Use `t test` to analyze.    
Assume there's no difference between Math and Physics. Then,     
```{r,echo=FALSE}
t.test(math.p,phy.p,paired=T)

```
From `t.test` above, p-value is `r t.test(math.p,phy.p,paired=T)$p.value`, which is much smaller than critical value 0.05. Therefore, we can conclude that there is a significant difference between Math and Physics grade.       


(2) How about Chinese and Math? I remember that most of my classmates in high school couldn't handle these two subjects at the same time. Is that true for this school? Let's check!    
```{r,echo=FALSE}
chinese.p<-grade$Chinese/150
plot(math.p~grade$Total,type="l",col="red",xlab="Total Grade",ylab="Subject Grade Percentage")
lines(chinese.p~grade$Total,col="blue")
legend(250,0.9,legend=c("Math","Chinese"),col=c("red","blue"),lwd=2)

```
   
```{r,echo=FALSE}
plot(math.p~chinese.p,pch=18,col="pink")
lm(math.p~chinese.p)
abline(b=0.97982,a=0.04356,lwd=2)
summary(lm(math.p~chinese.p))

```

     
Is there any difference between Math and Chinese? Use `t test` to analyze.    
Assume there's no difference between Math and Chinese. Then,     
```{r,echo=FALSE}
t.test(math.p,chinese.p,paired=T)

```
From `t.test` above, p-value is `r t.test(math.p,chinese.p,paired=T)$p.value`, which is much smaller than critical value 0.05. Therefore, we can conclude that there is a significant difference between Math and Chinese grade.     

(3) How about Chinese and English? Students might do better in Chinese than English, since Chinese is the native language for the test students.     
```{r,echo=FALSE}
eng.p<-grade$English/150
plot(chinese.p~grade$Total,type="l",col="red",xlab="Total Grade",ylab="Subject Grade Percentage")
lines(eng.p~grade$Total,col="blue")
legend(250,0.9,legend=c("Chinese","English"),col=c("red","blue"),lwd=2)

```
    
Are Chinese grades higher than English grades? Use `t test` to analyze.    
Assume there's Chinese grade is higher than English. Then,     
```{r,echo=FALSE}
t.test(chinese.p,eng.p,alternative="greater")

```
From `t.test` above, p-value is `r t.test(math.p,chinese.p,paired=T)$p.value`, which is much smaller than critical value 0.05. The estimated mean of Chinese and English are XXXXXXX and XXXXXXXX. It means grades of Chinese is better than that of English.
      
4. Relationships between a specific subject and total grade       
Now, think about the question in introduction. Is it true that high grades in `r colnames(grade)[5]` indicate high total grades?
      
      
      
      
5. Another high school in this district got an average total grade of 574.38. Assume both high schools have same standard deviation, could total grade of E high school has been drawn from the same distribution?    
```{r,echo=FALSE}
t.test(grade$Total,mu=574.38)

```

