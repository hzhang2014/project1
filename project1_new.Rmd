---
title: "Project1"
author: "Hui Zhang"
date: "Tuesday, October 21, 2014"
output: html_document
---

Introduction 
```{r,echo=FALSE}
grade <- read.table(file="project_new_2.txt", header=T)

```
This is the project for the first half of the semester for course Microbiol 612.This project will analyze the final grades of first-year high school students. All the data are download from [wenku.baidu.com](http://wenku.baidu.com/view/09f6dc3752ea551811a68727.html).      

There are two high schools. `r summary(grade$School)["D"]` students in D shool participated in this final exam, and `r summary(grade$School)["E"]` students in E school participated in the exam.In sum,  `r nrow(grade)` students are collected in this project. These two high schools are the best ones in the district. In this project, we will analyze the difference or similarity between them.
      
There are `r ncol(grade)-2` subjects in the final exam. The `r ncol(grade)-2` subjects are: `r colnames(grade)[3:10]`.When I was in high school, there were some interesting phenomenon, such as students with high grade in `r colnames(grade)[4]` and `r colnames(grade)[6]` also had higher total grades. Now, I will use the grades I collected to test these phenomenon.


Data Analysis    

1. Basic analysis of total grades in both schools    
```{r,echo=FALSE}
school.total.mean <- aggregate(grade$Total,by=list(grade$School),mean)
school.total.sd <- aggregate(grade$Total,by=list(grade$School),sd)
school.total.max <- aggregate(grade$Total,by=list(grade$School),max)
school.total.min <- aggregate(grade$Total,by=list(grade$School),min)

```
The maximum total grades in D school and E school are `r school.total.max$x`. The minimum total grades in D school and E school are `r school.total.min$x`. The mean total grades in D school and E school are `r school.total.mean$x`. The standard deviation for total grades of D school and E school are `r school.total.sd$x`. These summary information can be plotted out as below:      
```{r,echo=FALSE}
boxplot(grade$Total~grade$School,xlab="School",ylab="Total Grade",main="Summary of Total Grade")

```
       
From the figure above, we can see that the average total grade of E school is a little higher than that of D school. And the total grade of E school is more centralized, while D school is more dispersed. Then,do the total grades of D and E school follow normal distribution?    
```{r,echo=FALSE}
par(mfrow = c(1, 1))
d.total.hist <- hist(grade$Total[grade$School=="D"],plot=F,breaks=200)
plot(d.total.hist$density~d.total.hist$mids,type="h",ylab="Density",xlab="Total Grade",main="D School Total Grade Distribution")
d.total.mean <- mean(grade$Total[grade$School=="D"])
d.total.sd <- sd(grade$Total[grade$School=="D"])
points(0:1500,dnorm(0:1500,d.total.mean,d.total.sd),type="l",col="red",lwd=2)

e.total.hist <- hist(grade$Total[grade$School=="E"],plot=F,breaks=300)
plot(e.total.hist$density~e.total.hist$mids,type="h",ylab="Density",xlab="Total Grade",main="E School Total Grade Distribution")
e.total.mean <- mean(grade$Total[grade$School=="E"])
e.total.sd <- sd(grade$Total[grade$School=="E"])
points(0:1500,dnorm(0:1500,e.total.mean,e.total.sd),type="l",col="red",lwd=2)

```     
        
From the figures above, we can see that, total grade of E school follows normal distribution well, while D school are not well normally distributed. And total grade of D school are relatively more dispersed. This conclusion is in accordance with the boxplot above. But we can still take D school as normal distribution in future analysis.       
From figure of summary, we can see that the average grade is a little different. To be more precise, the mean total grade of D school and E school are `r school.total.mean$x`. Do the two high schools differ in total grade? Let's check with `t test`.    
Null hypothesis (H0) is: no difference between the two means. Then, the result of `Welch Two Sample t-test` is:        
```{r,echo=FALSE}
d.total <- grade$Total[grade$School=="D"]
e.total <- grade$Total[grade$School=="E"]
t.test(d.total,e.total)

```
`p value` of `Welch Two Sample t-test` is `r t.test(d.total,e.total)$p.value`, which is much smaller than 0.05. The probility of type I error is very small. It means, our null hypothesis should be rejected. Therefore, there is a siginificant difference between D and E school. Then, is it reliable that the mean total grade of E school greater than that of D school? We still use `Welch Two Sample t-test`.    
Our null hypothesis (H0) is: E school is same as D school in total grade,       
and alternative hypothesis (H1) is: E school is better than D school. The result is：    
```{r，echo=FALSE}
t.test(e.total,d.total,alternative="greater")

```
     
`p value` of `Welch Two Sample t-test` is `r t.test(e.total,d.total,alternative="greater")$p.value`, which is much smaller than 0.05. It means probility of type I error is very small. As a result, our null hypothesis should be rejected, and alternative hypothesis might be true. Therefore, in this final exam, E school did better than D school.   
      

2. Relationship between separate subjects       
All the following analysis between subjects are based on data of E school.      
(1) Chinese and English    
It is reasonable to assume that students do better in Chinese than English, in that Chinese is the native language for the students. Is that true?            
Here, null hypothesis (H0) is: There is no difference between Chinese and English.     
And alternative hypothesis (H1) is: Chinese grade is higher than English. Then,
```{r,echo=FALSE}
e.chinese.p <- grade$Chinese[grade$School=="E"]/150
e.eng.p <- grade$English[grade$School=="E"]/150
t.test(e.chinese.p,e.eng.p,alternative="greater")

```
From `t.test` above, p-value is `r t.test(e.chinese.p,e.eng.p,alternative="greater")$p.value`, which is very high. It means probability of type I error equals to 1. So we cannot reject null hypothesis. But high p value does not mean we can accept null hypothesis. In fact, it only suggests that there is not sufficient evidence against null hypothesis in favour of alternative hypothesis. Therefore, we only know grade of Chinese and English are different.       

(2) Math and Physics    
```{r,echo=FALSE}
par(mfrow = c(1, 1))
e.math <- grade$Math[grade$School=="E"]
e.phys <- grade$Physics[grade$School=="E"]
plot(e.phys~e.math,pch=20,xlab="Math Grade",ylab="Physics Grade",main="E School Math Grade vs Physics Grade",xlim=c(0,150),ylim=c(0,100))
segments(x0=0,x1=150*0.6,y0=60,y1=60,lty=2,col="green",lwd=2)
segments(x0=150*0.6,x1=150*0.6,y0=0,y1=60,lty=2,col="green",lwd=2)
segments(x0=0,x1=150*0.95,y0=95,y1=95,lty=2,col="blue",lwd=2)
segments(x0=150*0.95,x1=150*0.95,y0=0,y1=95,lty=2,col="blue",lwd=2)
legend(5,90,legend=c("Pass line","Excellent line"),col=c("green","blue"),lwd=2,lty=2)

```
        
Green lines in the figure above, means 60% of the maximum possible grade, i.e. the pass grade. And blue llines means 95% of the maximum possible grade, i.e. the excellent grade. We can see that, most students passed the exam of Math and Physics. But only a few students get the excellent grade.     

When solving physical problems, it is inevitable to use mathematical skills. Then, can we get a conclusion that higher Math grade contributes to higher Physics grade? We can do this by testing if there exist a positive linear correlation between Math grade and Physics grade.         
Are Math and Physics grade normally distributed? We need to check this first.    
```{r,echo=FALSE}
e.math.hist <- hist(grade$Math[grade$School=="E"],plot=F,breaks=200)
plot(e.math.hist$density~e.math.hist$mids,type="h",ylab="Density",xlab="Math Grade",main="E School Math Grade Distribution")
e.math.mean <- mean(e.math)
e.math.sd <- sd(e.math)
points(0:1500,dnorm(0:1500,e.math.mean,e.math.sd),type="l",col="red",lwd=2)
```

```{r,echo=FALSE}
e.phys.hist <- hist(e.phys,plot=F,breaks=200)
plot(e.phys.hist$density~e.phys.hist$mids,type="h",ylab="Density",xlab="Physics Grade",main="E School Physics Grade Distribution")
e.phys.mean <- mean(e.phys)
e.phys.sd <- sd(e.phys)
points(0:1500,dnorm(0:1500,e.phys.mean,e.phys.sd),type="l",col="red",lwd=2)
```
       
From figures above, we can see that Math grade is well normally distributed. But Physics grade is roughly normal distributed. Then, we can use `Pearson's product-moment correlation` test.    
If the alternative hypothesis (H1) is: the grade of Physics is positively associated with the grade of Math. Then the result is:

```{r,echo=FALSE}
cor.test(e.phys,e.math,method="pearson",alternative="greater")

```
From `Pearson's product-moment correlation` test, we get `p value` equals `r  cor.test(e.phys,e.math,method="pearson",alternative="greater")$p.value`. This small `p value` means we should reject our null hypothesis, and the alternative hypothesis might be true. And the `Pearson product-moment correlation coefficient` is 0.669. Therefore, there might be a positive correlation between Math and Physics grade.         
Then we can find is there a linear regression between the two subjects.      
```{r,echo=FALSE}
plot(e.phys~e.math,pch=20,xlab="Math Grade",ylab="Physics Grade",main="E School Math Grade vs Physics Grade",xlim=c(0,150),ylim=c(0,100))
legend(5,95,legend=c("Linear model"),col=c("red"),lwd=2,lty=1)
abline(b=0.6369,a=-4.9655,lwd=2,col="red")
summary(lm(e.phys~e.math))

```                 
       
So there exists a linear regression, with `intercept` of -4.9655 and slope of 0.6369. Therefore, good Math skills do contribute to Physics grade.    


3. Relationship between subject and total grade      
All the following analysis are based on data from E school.        
Though all the subjects contribute to the total grade, they might have different weight. For example, if weight of Math is biggest, then higher Math grade could lead to higher total grade. Here, we could test the weight of subjects Physics and History. These two subjects have the same maximum possible grade, 100. However, the maximum possible grade of Math is 150.        

Physics, history vs total grade          

We use `Pearson's product-moment correlation` test.    
For Physics:        

```{r,echo=FALSE}
cor.test(e.total,e.phys,method="pearson")

```
The `Pearson product-moment correlation coefficient` is 0.6923412.       

For History: 

```{r,echo=FALSE}
e.hist <- grade$History[grade$School=="E"]
cor.test(e.total,e.hist,method="pearson")

```
       
The `Pearson product-moment correlation coefficient` is 0.5402196, which is smaller than the coefficient of Physics and total grade. Larger coefficient means closer correlation. Therefore, we verify the early assumption, that Physics contributes more to total grade.

